<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>لیست فروشگاه‌ها</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 p-4">

  <!-- دکمه معرفی کارت رفاهی (وسط و متمایز) -->
  <div class="max-w-6xl mx-auto mb-4 flex justify-center">
    <button onclick="showVideoModal()"
      class="bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium px-4 py-2 rounded w-full sm:w-auto">
      معرفی کارت رفاهی
    </button>
  </div>

  <!-- باکس جستجو -->
  <div class="max-w-6xl mx-auto mb-6 grid grid-cols-1 sm:grid-cols-3 gap-4">
    <input type="text" id="cityInput" placeholder="جستجو بر اساس شهر" class="p-2 rounded border">
    <input type="text" id="storeInput" placeholder="جستجو بر اساس نام فروشگاه" class="p-2 rounded border">
    <input type="text" id="categoryInput" placeholder="جستجو بر اساس صنف" class="p-2 rounded border">
  </div>

  <!-- دکمه‌های مزایای کارت رفاهی + مهلت استفاده + نرخ کارمزد -->
  <div class="max-w-6xl mx-auto mb-6 flex flex-col sm:flex-row justify-center gap-4">
    <button onclick="showBenefitsModal()" class="bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium px-4 py-2 rounded w-full sm:w-auto">
      مزایای کارت رفاهی
    </button>
    <button onclick="showUseModal()" class="bg-green-500 hover:bg-green-600 text-white text-sm font-medium px-4 py-2 rounded w-full sm:w-auto">
      مهلت استفاده و مدت بازپرداخت
    </button>
    <button onclick="showFeeModal()" class="bg-red-500 hover:bg-red-600 text-white text-sm font-medium px-4 py-2 rounded w-full sm:w-auto">
      نرخ کارمزد
    </button>
  </div>

  <!-- عنوان بالای جدول -->
  <div class="max-w-6xl mx-auto mb-4">
    <h1 class="text-2xl font-bold text-center text-blue-700 dark:text-blue-400 mb-6">لیست فروشگاه‌ها</h1>
  </div>

  <!-- جدول فروشگاه‌ها -->
  <div class="max-w-6xl mx-auto overflow-x-auto">
    <table id="storeTable" class="min-w-full bg-white dark:bg-gray-800 rounded shadow">
      <thead>
        <tr class="bg-blue-100 dark:bg-blue-700 text-gray-700 dark:text-white">
          <th class="p-2 text-right">شهر</th>
          <th class="p-2 text-right">نام فروشگاه</th>
          <th class="p-2 text-right">صنف</th>
          <th class="p-2 text-right">آدرس</th>
          <th class="p-2 text-right">شماره تلفن</th>
        </tr>
      </thead>
      <tbody class="text-gray-700 dark:text-gray-300">
        <!-- اینجا ردیف‌ها لود میشن -->
      </tbody>
    </table>
  </div>

  <!-- مودال‌ها -->
  <div id="videoModal" class="fixed inset-0 hidden bg-black bg-opacity-70 flex items-center justify-center p-4 z-50">
    <div class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden relative max-w-2xl w-full">
      <button onclick="closeVideoModal()" class="absolute top-2 left-2 text-gray-700 dark:text-gray-300">&times;</button>
      <div class="relative" style="padding-top: 56.25%;">
        <iframe id="videoFrame" class="absolute inset-0 w-full h-full" src="" frameborder="0" allowfullscreen></iframe>
      </div>
    </div>
  </div>

  <div id="benefitsModal" class="fixed inset-0 hidden bg-black bg-opacity-70 flex items-center justify-center p-4 z-50">
    <div class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden p-6 max-w-md w-full relative">
      <button onclick="closeBenefitsModal()" class="absolute top-2 left-2 text-gray-700 dark:text-gray-300">&times;</button>
      <h2 class="text-lg font-bold mb-2">مزایای کارت رفاهی</h2>
      <p class="text-sm leading-6">
        <strong>مزایای کارت رفاهی برای دارندگان کارت:</strong><br>
        افزایش قدرت خرید مشتریان<br>
        دریافت اعتبار خرید کالا بدون نیاز به ایجاد میانگین حساب<br>
        هزینه پایین تأمین مالی برای مشتریان<br><br>
        <strong>مزایای کارت رفاهی برای پذیرندگان:</strong><br>
        افزایش ظرفیت اعتباری به منظور تأمین مالی<br>
        تضمین بازپرداخت اوراق گام توسط بانک و کاهش ریسک نکول در ارائه خدمت فروش اقساطی کالا<br>
        افزایش فروش و امکان فروش متقاطع<br>
        قابلیت انتقال اوراق در زنجیره تأمین<br>
        قابلیت تنزیل در صورت نیاز به منابع مالی به منظور تأمین سرمایه در گردش<br>
        استفاده از اوراق گام در تسویه معاملات بورس کالا<br>
        انتقال به دستگاه‌های اجرایی بابت پرداخت بدهی به قیمت اسمی اوراق
      </p>
    </div>
  </div>

  <div id="useModal" class="fixed inset-0 hidden bg-black bg-opacity-70 flex items-center justify-center p-4 z-50">
    <div class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden p-6 max-w-md w-full relative">
      <button onclick="closeUseModal()" class="absolute top-2 left-2 text-gray-700 dark:text-gray-300">&times;</button>
      <p class="text-sm leading-6">
        مهلت استفاده از اعتبار، از تاریخ صدور تا آخرین روز ماه بعد و مدت بازپرداخت اقساط ١٢ ماه در اقساط مساوی و ماهیانه است.
      </p>
    </div>
  </div>

  <div id="feeModal" class="fixed inset-0 hidden bg-black bg-opacity-70 flex items-center justify-center p-4 z-50">
    <div class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden p-6 max-w-md w-full relative">
      <button onclick="closeFeeModal()" class="absolute top-2 left-2 text-gray-700 dark:text-gray-300">&times;</button>
      <p class="text-sm leading-6">
        3% مبلغ خرید که در اقساط مساوی همزمان با وصول اقساط دریافت می‌شود.
      </p>
    </div>
  </div>

  <!-- اسکریپت‌ها -->
  <script>
    function showVideoModal() {
      document.getElementById('videoModal').classList.remove('hidden');
      document.getElementById('videoFrame').src = "https://www.aparat.com/video/video/embed/videohash/blep93a/vt/frame";
    }
    function closeVideoModal() {
      document.getElementById('videoModal').classList.add('hidden');
      document.getElementById('videoFrame').src = "";
    }
    function showBenefitsModal() {
      document.getElementById('benefitsModal').classList.remove('hidden');
    }
    function closeBenefitsModal() {
      document.getElementById('benefitsModal').classList.add('hidden');
    }
    function showUseModal() {
      document.getElementById('useModal').classList.remove('hidden');
    }
    function closeUseModal() {
      document.getElementById('useModal').classList.add('hidden');
    }
    function showFeeModal() {
      document.getElementById('feeModal').classList.remove('hidden');
    }
    function closeFeeModal() {
      document.getElementById('feeModal').classList.add('hidden');
    }

    // بارگذاری اطلاعات جدول از CSV
    fetch('stores.csv')
      .then(response => response.text())
      .then(data => {
        const rows = data.trim().split('\n').slice(1);
        const tbody = document.querySelector('#storeTable tbody');
        rows.forEach(row => {
          const cols = row.split(',');
          const tr = document.createElement('tr');
          cols.forEach((col, index) => {
            const td = document.createElement('td');
            td.className = "border-t p-2";
            if (index === 4) {
              td.innerHTML = `<a href="tel:${col.trim()}" class="text-blue-600 hover:underline">${col.trim()}</a>`;
            } else {
              td.textContent = col.trim();
            }
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      });

    // فیلتر جستجو
    document.getElementById('cityInput').addEventListener('input', filterTable);
    document.getElementById('storeInput').addEventListener('input', filterTable);
    document.getElementById('categoryInput').addEventListener('input', filterTable);

    function filterTable() {
      const cityValue = document.getElementById('cityInput').value.toLowerCase();
      const storeValue = document.getElementById('storeInput').value.toLowerCase();
      const categoryValue = document.getElementById('categoryInput').value.toLowerCase();
      const rows = document.querySelectorAll('#storeTable tbody tr');

      rows.forEach(row => {
        const city = row.children[0].textContent.toLowerCase();
        const store = row.children[1].textContent.toLowerCase();
        const category = row.children[2].textContent.toLowerCase();

        if (city.includes(cityValue) && store.includes(storeValue) && category.includes(categoryValue)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
    }
  </script>

</body>
</html>
